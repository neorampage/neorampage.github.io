---
layout: post
title: TryHackMe - Lian_Yu WriteUp
categories: [TryHackMe, WriteUps, Hacking]
tags: [tryhackme, writeups, hacking]
description: A beginner level security challenge
img: /thm/Lian_Yu/cover.png
---
 ![Cover](/assets/media/thm/Lian_Yu/cover.png)

> Let's start with our nmap scan.

```
nmap -sV 10.10.55.215
```

![nmap](/assets/media/thm/Lian_Yu/nmap.png)

> I found that the machine has web service on port 80, so I can use my web browser to try to get something.

![browser](/assets/media/thm/Lian_Yu/browser.png)

> Nothing special!
>
> Mmmmm... If I try to get **robots.txt**?*

![robots](/assets/media/thm/Lian_Yu/robots.png)

> Bad luck!!, the website doesn't have it.
>
> Now I'm going to try with **gobuster** and maybe I can get some directories

```
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://10.10.55.215/
```

![gobuster1](/assets/media/thm/Lian_Yu/gobuster1.png)

> Great! I found **/island**
>
> I use this in my web browser again.

![island1](/assets/media/thm/Lian_Yu/island1.png)

> I can see the text is not complete, so I'm going to try to see the source code.
>
> **¡¡¡Bingo!!!**

![island2](/assets/media/thm/Lian_Yu/island2.png)

> And now what?
> Is a good idea if I run gobuster again but this time in **/Island** directory

![gobuster2](/assets/media/thm/Lian_Yu/gobuster2.png)

> Perfect!! I found **/2100** directory.
> I'm check the new directory in the browser.

![2100](/assets/media/thm/Lian_Yu/2100.png)

> I watched the video and It was not helpful, maybe I need to see the source code again.
>
> Okay!!! I got something interesting.

![ticket](/assets/media/thm/Lian_Yu/ticket.png)

> I spent many hours thinking what can I do here?, so after a few hours I thought that **.ticket** could be an extension, but where could it be used? I'll use this right here at **/2100**, following the advice I found in he source code.
>
> So let's try gobuster again

```
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://10.10.55.215/island/2100 -x .ticket
```

![gobuster3](/assets/media/thm/Lian_Yu/gobuster3.png)

> I found **green_arrow.ticket** and if I try to open the I find this.

![green_arrow.png](/assets/media/thm/Lian_Yu/green_arrow.png)

> I think the text is encrypt. Cipher are not a easy subject for me, so It will take me some time to get the correct way to decrypt the cipher.
> After some hours I found the correct way to decrypt the cipher using **base58** 

![base58](/assets/media/thm/Lian_Yu/base58.png)

> Okay! Let's try to login using **FTP** with the credentials that I found 

![ftp](/assets/media/thm/Lian_Yu/ftp.png)

> Great!!! I'm in!!
> I'm going to use **ls** for list all files and directories.

![ls](/assets/media/thm/Lian_Yu/ls.png)

> Downloading the images

![download](/assets/media/thm/Lian_Yu/download.png)

> Maybe the machine has other users, so It is a good idea to cheack home directory.

![home](/assets/media/thm/Lian_Yu/home.png)

> If I verify the images headers with exiftool I got this error in one of the three images

![leave](/assets/media/thm/Lian_Yu/leave.png)


NOTA: esto fue investigado en un writeup
Verificando las imagenes con exiftool



al parecer la imagen *Leave_me_alone.png* es un imagen corrupta.

Nota: Pase muchisimas horas intentando descubriri que podes realizar a este punto, pero nada funcionaba. Asi que me fui a ver esta parte algun WriteUp que encontrara en internet.

Lo que primero necesitamos encontrar el *Hex Gradient PNG

![hex1](/assets/media/thm/Lian_Yu/hex1.png)

Luego modificamos la imagen corrupta mediante el uso del hexeditor (puedes ocupar el que tu quieras) hasta que quede los primeros digitols de las primeras 6 columnas de las misma forma que el "Hex Gradient PNG"

![hex2](/assets/media/thm/Lian_Yu/hex2.png)

Cuando la imagen este reparadas lo que obtendremos sera una imagen que al parecer nos esta porporcionando una password.

Con el uso de la herramienta de steghide verificamos si las imagenes contiene informacion oculta dentro de ellas.

![steg1](/assets/media/thm/Lian_Yu/steg1.png)
No esta solicitando una contraseña para poder listar información oculta en la imagen, en lo cual usamos la contraseña que la imagen no proporciono. 

![teg2](/assets/media/thm/Lian_Yu/steg2.png)

para el caso de las otras dos imagenes el formato PNG no es reconocido 


![img1](/assets/media/thm/Lian_Yu/img1.png)

![img2](/assets/media/thm/Lian_Yu/img2.png)

extrayendo el zip de aa.jpg

Obtenemos un *.zip*, el cual lo descomprimimos y obtenemos a ***passd.txt*** y ***shado***
![zip](zip)

Con esto ultimo estariamos completos para realizar el login mediante el protocolo de ssh.

Nota: Para este punto se deberia tener identificado las credenciles para realizar el login con SSH, de no ser asi te aconsejo que te vuelvas a conetactar por FTP y mires que otros usuarios pueden haber.


Ahora ingresamos por ssh, una vez adentro, realizamos un *ls* y otros comandos linux para la obtencion de user.txt

![user](/assets/media/thm/Lian_Yu/user.png)

Verificando que podemos ejecutar con sudo, encontramos que se puede ejecutar la herramienta ***pkexec***

![pkexec](/assets/media/thm/Lian_Yu/pkexec.png)

Segun la guia de ayuda de la misma herramienta, esta nos permite ejecutar comandos a los que otros usuarios tiene acceso.

Asi que para obtner una terminal con permisos root ejecutamos el comando:
```
sudo pkexec --user root /bin/bash
```
![bash](/assets/media/thm/Lian_Yu/bash.png)

Muchas gracias por llegar hasta el final, espero que les fuera de mucha ayuda este writeup.

Happy Hacking!!!


